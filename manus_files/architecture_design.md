# Application Architecture and Flow Design

## 1. Overview
This document outlines the proposed architecture and flow for the PHP application that automates WordPress website creation. The application will take a Vietnam Business License number and user-selected color palette as input, then leverage various APIs and web scraping to generate a complete, professional WordPress website.

## 2. Core Components

The application will consist of the following core components:

*   **User Interface (UI):** A web-based interface for user input (Business License number, color palette).
*   **Business Data Collector:** Module responsible for fetching and crawling business information.
*   **AI Content Generator:** Integrates with OpenAI to generate sitemaps, page content, and blog articles.
*   **WordPress Integrator:** Communicates with WordPress via its REST API to create and manage content.
*   **Image Manager:** Searches for and integrates free stock images.
*   **File Manager:** Handles saving generated content (Markdown files) and images locally.

## 3. Application Flow

The application flow can be broken down into the following steps:

1.  **User Input:**
    *   The user accesses the PHP application's web interface.
    *   They input a Vietnam Business License number (TAX code).
    *   They select a preferred color palette from a set of options.
    *   The application validates the input.

2.  **Business Information Collection:**
    *   The Business Data Collector receives the TAX code.
    *   It attempts to retrieve business information (company name, address, phone number, registered services/field of business/main industry) using available APIs or web scraping techniques. (Initial research suggests no direct public API for Vietnam Business Licenses, so web scraping will be the primary method).
    *   The collected data is stored temporarily.

3.  **AI-Powered Content Generation:**
    *   The AI Content Generator sends the collected business information to OpenAI.
    *   **Sitemap Suggestion:** OpenAI suggests a sitemap structure based on the business's industry and services.
    *   **Content Page Generation:** For each suggested page in the sitemap, OpenAI generates detailed content in Markdown format.
    *   **Blog Article Generation:** OpenAI generates 5 blog articles relevant to the business's industry and services, also in Markdown format.
    *   All generated Markdown content is saved to local files by the File Manager.

4.  **WordPress Website Creation:**
    *   The WordPress Integrator connects to a pre-configured WordPress instance (or creates a new one if feasible within the scope).
    *   **Page Creation:** It creates WordPress pages using the content generated by OpenAI.
    *   **Post Creation:** It creates WordPress blog posts using the generated articles.
    *   **Menu Creation:** It creates navigation menus based on the sitemap.
    *   **Theme and Customization:** The application will apply a default theme and attempt basic customization based on the selected color palette (this might require a theme that supports extensive customization via API or direct database manipulation, or a custom theme).

5.  **Image Integration:**
    *   The Image Manager searches for free stock images relevant to the generated pages and blog articles.
    *   **Featured Images:** It sets featured images for blog posts.
    *   **Inline Images:** It inserts relevant images into the content of pages and posts.
    *   Images are downloaded and uploaded to the WordPress media library.

6.  **Finalization and Output:**
    *   The application confirms the successful creation of the WordPress website.
    *   It provides the user with the URL of the newly created website.

## 4. Technology Stack

*   **Backend:** PHP
*   **Web Scraping:** PHP libraries (e.g., Goutte, Simple HTML DOM Parser) or custom cURL implementations.
*   **AI Integration:** OpenAI API (via PHP cURL or a dedicated PHP client library).
*   **WordPress Interaction:** WordPress REST API (preferred) or XML-RPC (fallback/alternative for specific functions).
*   **Image Search:** APIs from free stock image providers (e.g., Unsplash API, Pexels API).
*   **Frontend:** HTML, CSS, JavaScript (for UI and basic interactivity).

## 5. Considerations and Challenges

*   **Vietnam Business License Data:** The primary challenge is reliably obtaining business information from a TAX code. Since direct public APIs are unlikely, robust web scraping of official government or business registry websites will be crucial. This requires careful handling of website structure changes and potential CAPTCHAs.
*   **WordPress Theme Customization:** Applying a color palette and achieving a 


professional look based on a color palette will depend heavily on the chosen WordPress theme. A highly customizable theme or a custom-built theme will be necessary.
*   **OpenAI API Usage:** Careful prompt engineering will be required to ensure the generated sitemaps, page content, and blog articles are relevant, high-quality, and adhere to the business context.
*   **Error Handling and Robustness:** The application needs comprehensive error handling for API failures, web scraping issues, and WordPress integration problems.
*   **Scalability:** While initially for single-user use, consider future scalability if this becomes a service.
*   **Security:** Secure handling of API keys (OpenAI, image APIs) and WordPress credentials is paramount.

## 6. API Choices for WordPress Interaction

### WordPress REST API (Preferred)

The WordPress REST API is the modern and recommended way to interact with WordPress programmatically. It offers a structured, JSON-based interface for managing posts, pages, users, media, and more. Its advantages include:

*   **Modern and Flexible:** Built on standard web technologies (HTTP, JSON), making it easier to integrate with modern applications.
*   **Extensible:** Highly extensible, allowing custom endpoints and data to be exposed.
*   **Better Performance:** Generally more performant than XML-RPC due to its stateless nature and efficient data transfer.
*   **Security:** Designed with security in mind, using nonce-based authentication for authenticated requests.

### WordPress XML-RPC API (Fallback/Alternative)

XML-RPC is an older protocol for remote procedure calls using HTTP and XML. While still supported by WordPress, it has largely been superseded by the REST API. Its use might be considered in specific scenarios:

*   **Legacy Compatibility:** If interacting with very old WordPress installations that do not have the REST API enabled or fully functional.
*   **Specific Functions:** In rare cases, certain niche functionalities might still be more easily accessible via XML-RPC if not yet fully exposed in the REST API.

**Recommendation:** The primary method for WordPress interaction will be the **WordPress REST API**. XML-RPC will only be considered as a fallback if specific functionalities prove difficult or impossible to achieve with the REST API.

## 7. Security Considerations

*   **API Key Management:** All API keys (OpenAI, image APIs) should be stored securely, preferably as environment variables or in a secure configuration file outside the web root, and never hardcoded in the application.
*   **WordPress Credentials:** WordPress administrator credentials used by the application should be treated with the highest level of security. Consider using application-specific users with minimal necessary permissions.
*   **Input Validation and Sanitization:** All user inputs (e.g., Business License number) must be thoroughly validated and sanitized to prevent injection attacks and other vulnerabilities.
*   **Web Scraping Ethics and Legality:** Ensure that web scraping activities comply with the terms of service of the target websites and relevant legal regulations. Implement delays and user-agent rotation to avoid being blocked.
*   **Error Logging:** Implement robust error logging to monitor application health and identify potential security breaches or functional issues.

## 8. Future Enhancements

*   **Multi-language Support:** Extend the application to support content generation and website creation in multiple languages.
*   **Advanced Theme Customization:** Integrate with a theme customizer API or provide more granular control over design elements.
*   **E-commerce Integration:** Add support for WooCommerce or other e-commerce platforms.
*   **Analytics Integration:** Automatically set up basic analytics for the newly created website.

This architecture provides a solid foundation for building the automated WordPress website creation application. The next steps will involve detailed research into specific APIs and libraries, followed by implementation of each component.

